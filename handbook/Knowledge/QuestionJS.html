<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JS问答 | JavaScript 文档</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="小白学习笔记">
    
    <link rel="preload" href="/learn-javascript/assets/css/0.styles.e5857eef.css" as="style"><link rel="preload" href="/learn-javascript/assets/js/app.5bbd33bb.js" as="script"><link rel="preload" href="/learn-javascript/assets/js/2.6b100304.js" as="script"><link rel="preload" href="/learn-javascript/assets/js/10.e4551c7c.js" as="script"><link rel="prefetch" href="/learn-javascript/assets/js/11.d264f280.js"><link rel="prefetch" href="/learn-javascript/assets/js/3.47d2c21d.js"><link rel="prefetch" href="/learn-javascript/assets/js/4.bba4ef46.js"><link rel="prefetch" href="/learn-javascript/assets/js/5.d250cb53.js"><link rel="prefetch" href="/learn-javascript/assets/js/6.8779df89.js"><link rel="prefetch" href="/learn-javascript/assets/js/7.d9d133a5.js"><link rel="prefetch" href="/learn-javascript/assets/js/8.1bc85b37.js"><link rel="prefetch" href="/learn-javascript/assets/js/9.2922fe0a.js">
    <link rel="stylesheet" href="/learn-javascript/assets/css/0.styles.e5857eef.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/learn-javascript/" class="home-link router-link-active"><!----> <span class="site-name">JavaScript 文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/learn-javascript/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="我的JavaScript博客" class="dropdown-title"><span class="title">我的JavaScript博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="我的JavaScript博客" class="mobile-dropdown-title"><span class="title">我的JavaScript博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Followinsider" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/1381438820986472/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/learn-javascript/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="我的JavaScript博客" class="dropdown-title"><span class="title">我的JavaScript博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="我的JavaScript博客" class="mobile-dropdown-title"><span class="title">我的JavaScript博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Followinsider" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/1381438820986472/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/learn-javascript/" class="sidebar-heading clickable router-link-active"><span>回到首页</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-javascript/handbook/Idea.html" class="sidebar-link">学前必读</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/learn-javascript/handbook/Knowledge" class="sidebar-heading clickable router-link-active open"><span>JS知识 &amp; JS问答</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-javascript/handbook/Knowledge/JsFirstStep.html" class="sidebar-link">JS知识</a></li><li><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html" aria-current="page" class="active sidebar-link">JS问答</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_1-什么是事件代理-委托" class="sidebar-link">1.什么是事件代理/委托？</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_2-js中的this是如何工作的" class="sidebar-link">2.js中的this是如何工作的？</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_3-原型继承的原理" class="sidebar-link">3.原型继承的原理</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_4-js模块化" class="sidebar-link">4.JS模块化</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_5-描述以下变量的区别-null-undefined-或-undeclared-dɪˈkleəd" class="sidebar-link">5.描述以下变量的区别：null，undefined 或 undeclared(/ dɪˈkleəd /)？</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_6-请举出一个匿名函数的典型用例" class="sidebar-link">6.请举出一个匿名函数的典型用例</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_7-js的宿主对象和原生对象的区别" class="sidebar-link">7.JS的宿主对象和原生对象的区别</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_8-call和apply的区别是什么" class="sidebar-link">8. call和apply的区别是什么？</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_9-bind的手写" class="sidebar-link">9.bind的手写</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_10-ajax的工作原理以及优缺点" class="sidebar-link">10.Ajax的工作原理以及优缺点</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_11-jsonp的原理" class="sidebar-link">11.JSONP的原理</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_12-请解释变量声明提升" class="sidebar-link">12.请解释变量声明提升</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_13-请描述事件捕获和事件冒泡机制" class="sidebar-link">13.请描述事件捕获和事件冒泡机制</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_14-attribute和property的区别是什么" class="sidebar-link">14.Attribute和Property的区别是什么？</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_15-请解释js的同源策略" class="sidebar-link">15.请解释js的同源策略</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_16-如何实现下列代码" class="sidebar-link">16.如何实现下列代码</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_17-三元表达式" class="sidebar-link">17.三元表达式</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_18-什么是-use-strict-使用它的好处和坏处分别是什么" class="sidebar-link">18.什么是 &quot;use strict&quot;; ? 使用它的好处和坏处分别是什么？</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_19-说说promise" class="sidebar-link">19.说说Promise</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_20-请解释同步和异步函数的区别" class="sidebar-link">20.请解释同步和异步函数的区别</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_21-函数声明和函数表达式的区别" class="sidebar-link">21.函数声明和函数表达式的区别</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_22-settimeout和promise的区别" class="sidebar-link">22.setTimeout和promise的区别</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_23-什么是事件循环-event-loop" class="sidebar-link">23.什么是事件循环 Event loop</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_24-什么是闭包-词法作用域" class="sidebar-link">24.什么是闭包(词法作用域)？</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_25-for-in-和for-of的区别" class="sidebar-link">25.for in 和for of的区别</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_26-new一个对象-这个过程发生了什么" class="sidebar-link">26.new一个对象，这个过程发生了什么？</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_27-typeof-与-instanceof-区别" class="sidebar-link">27.typeof 与 instanceof 区别</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_28-跨域问题有哪些处理方式" class="sidebar-link">28.跨域问题有哪些处理方式</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_29-防抖和节流是什么" class="sidebar-link">29.防抖和节流是什么？</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_30-和-的区别" class="sidebar-link">30.== 和 ===的区别</a></li><li class="sidebar-sub-header"><a href="/learn-javascript/handbook/Knowledge/QuestionJS.html#_31-其他途径" class="sidebar-link">31.其他途径</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1-什么是事件代理-委托"><a href="#_1-什么是事件代理-委托" class="header-anchor">#</a> 1.什么是事件代理/委托？</h2> <p><strong>事件委托也称之为事件代理（Event Delegation）。是JavaScript中常用绑定事件的常用技巧。顾名思义，“事件代理”即是把原本需要绑定在子元素的响应事件委托给父元素，让父元素担当事件监听的职务。事件代理的原理是DOM元素的事件冒泡。</strong></p> <p>事件代理的优点：</p> <p><strong>【1】可以大量节省内存占用，减少事件注册</strong>。比如在ul上代理所有li的click事件就非常棒</p> <p><strong>【2】可以实现当新增子对象时无需再次对其绑定（动态绑定事件）</strong></p> <p><strong>Tips：</strong></p> <p>使用“事件委托”时，并不是说把事件委托给的元素越靠近顶层就越好。事件冒泡的过程也需要耗时，越靠近顶层，事件的”事件传播链”越长，也就越耗时。如果DOM嵌套结构很深，事件冒泡通过大量祖先元素会导致性能损失</p> <h2 id="_2-js中的this是如何工作的"><a href="#_2-js中的this是如何工作的" class="header-anchor">#</a> 2.js中的<code>this</code>是如何工作的？</h2> <h3 id="this的误解"><a href="#this的误解" class="header-anchor">#</a> <strong>this的误解：</strong></h3> <p><strong>2.1 指向自身</strong></p> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/26762664/1672743777455-84a5f94e-64ff-41ab-9a8c-219a0ca321a5.png#averageHue=%23202226&amp;clientId=u8c93e3cd-3960-4&amp;from=paste&amp;height=419&amp;id=u4c6b794e&amp;name=image-20220928144411812.png&amp;originHeight=524&amp;originWidth=439&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=20104&amp;status=done&amp;style=none&amp;taskId=uf237327d-87ed-4ae7-b368-ccf14053c40&amp;title=&amp;width=351.2" alt="image-20220928144411812.png"></p> <p><strong>2.2 它的作用域</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ReferenceError: a is not defined</span>
</code></pre></div><p><code>每当你想要把 this 和词法作用域的查找混合使用时，一定要提醒自己，这是无法实现的。</code></p> <p><strong>this 实际上是在函数被调用时发生的绑定，它指向什么完全取决于函数在哪里被调用。</strong></p> <h3 id="this的工作流程"><a href="#this的工作流程" class="header-anchor">#</a> this的工作流程</h3> <p>回到问题，首先是判断this的调用位置，分析出真正的调用位置；其次根据绑定规则判断this是用了什么绑定，如</p> <p>默认绑定（在非strict mode 下时，默认绑定才能绑定到全局对象；严格模式下与 <strong>foo()</strong> 的调用位置无关）、</p> <p>隐式绑定（判断是否有上下文对象，注意这个绑定的<strong>隐式丢失</strong>问题）、</p> <p>显式绑定（如call()、apply()方法这些传入值将作为this的绑定对象，传入值会被**'装箱'**）、</p> <p>new绑定（在js中，new一个函数实际只是对于这个函数进行构造调用，而非存在构造函数）</p> <p>使用 new 来调用函数，或者说发生构造函数调用时，会自动执行下面的操作。</p> <ol><li>创建（或者说构造）一个全新的对象。</li> <li>这个新对象会被执行 [[ 原型 ]] 连接。</li> <li>这个新对象会绑定到函数调用的 this。</li> <li>如果函数没有返回其他对象，那么 new 表达式中的函数调用会自动返回这个新对象。</li></ol> <p><strong>上面调用规则优先级：默认&lt; 隐式 &lt; 显式 &lt; new</strong></p> <ol><li>函数是否在 new 中调用（new 绑定）？如果是的话 this 绑定的是新创建的对象。 var bar = <strong>new</strong> foo()</li> <li>函数是否通过 call、apply（显式绑定）或者硬绑定调用？如果是的话，this 绑定的是 指定的对象。 var bar = foo.call(<strong>obj2</strong>)</li> <li>函数是否在某个上下文对象中调用（隐式绑定）？如果是的话，this 绑定的是那个上下文对象。 var bar = <strong>obj1</strong>.foo()</li> <li>如果都不是的话，使用默认绑定。如果在严格模式下，就绑定到 undefined，否则绑定到全局对象。 var bar = foo()</li></ol> <h3 id="小结"><a href="#小结" class="header-anchor">#</a> 小结：</h3> <p>如果要判断一个运行中函数的 this 绑定，就需要找到这个函数的直接调用位置。找到之后就可以顺序应用下面这<strong>四条规则</strong>来判断 this 的绑定对象。</p> <ol><li>由 new 调用？绑定到新创建的对象。</li> <li>由 call 或者 apply（或者 bind）调用？绑定到指定的对象。</li> <li>由上下文对象调用？绑定到那个上下文对象。</li> <li>默认：在严格模式下绑定到 undefined，否则绑定到全局对象。 一定要注意，有些调用可能在无意中使用默认绑定规则。</li></ol> <p>如果想“更安全”地忽略 this 绑 定，你可以使用一个 <code>DMZ 对象</code>以保护全局对象。 比如</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>ø <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>ES6 中的箭头函数并不会使用四条标准的绑定规则，而是根据当前的词法作用域来决定 this，具体来说，箭头函数会继承外层函数调用的 this 绑定（无论 this 绑定到什么）。这其实和 ES6 之前代码中的 self = this 机制一样</strong></p> <h2 id="_3-原型继承的原理"><a href="#_3-原型继承的原理" class="header-anchor">#</a> 3.原型继承的原理</h2> <p>原型继承主要是通过[[Prototype]]属性进行连接，通过原型继承多个引用类型的属性和方法。</p> <p>讲继承原理，首先我得重温构造函数、原型和实例的关系：</p> <p>每个构造函数都有一个原型对象，原型对象有一个属性指回构造函数，而实例有一个内部指针指向原型，而当构造函数的原型是另外一个构造函数的实例()时，其实这时候就会将两个原型对象给串联起来，当依此类推串联起多个原型形成一条链状，也即我们称为的原型链。</p> <p><strong>Keys：</strong></p> <p><img src="https://camo.githubusercontent.com/9a69b0f03116884e80cf566f8542cf014a4dd043fce6ce030d615040461f4e5a/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f6d717971696e6766656e672f426c6f672f496d616765732f70726f746f74797065352e706e67#id=vgiA8&amp;originHeight=525&amp;originWidth=590&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""></p> <p><strong>Tips：</strong></p> <p><strong>1.constructor属性：</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Person<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>当获取 person.constructor 时，其实 person 中并没有 constructor 属性,当不能读取到constructor 属性时，会从 person 的原型也就是 Person.prototype 中读取，正好原型中有该属性，所以：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>person<span class="token punctuation">.</span>constructor <span class="token operator">===</span> <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token comment">// true</span>
</code></pre></div><p><strong>2.</strong><code>__proto__</code></p> <p>绝大部分浏览器都支持这个非标准的方法访问原型，然而它并不存在于 Person.prototype 中，实际上，它是来自于 Object.prototype ，与其说是一个属性，不如说是一个 getter/setter，当使用 obj.<strong>proto</strong> 时，可以理解成返回了 Object.getPrototypeOf(obj)。</p> <p><strong>3.真的是继承吗？</strong></p> <p>继承意味着复制操作，然而 JavaScript 默认并不会复制对象的属性，相反，JavaScript 只是在两个对象之间创建一个关联，这样，一个对象就可以通过委托访问另一个对象的属性和函数，所以与其叫继承，委托的说法反而更准确些。</p> <h2 id="_4-js模块化"><a href="#_4-js模块化" class="header-anchor">#</a> 4.JS模块化</h2> <h3 id="_1-commonjs"><a href="#_1-commonjs" class="header-anchor">#</a> 1.CommonJS</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 定义模块 math.js </span>
<span class="token keyword">var</span> basicNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span> 
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> 
    <span class="token comment">//在这里写上需要向外暴露的函数、变量  </span>
    <span class="token literal-property property">add</span><span class="token operator">:</span> add<span class="token punctuation">,</span>  
    <span class="token literal-property property">basicNum</span><span class="token operator">:</span> basicNum 
<span class="token punctuation">}</span> 


<span class="token comment">// 引用自定义的模块时，参数包含路径，可省略.js </span>
<span class="token keyword">var</span> math <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./math'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
math<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// 引用核心模块时，不需要带路径 </span>
<span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
http<span class="token punctuation">.</span><span class="token function">createService</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-amd和require-js"><a href="#_2-amd和require-js" class="header-anchor">#</a> 2.AMD和require.js</h3> <p>AMD规范采用异步方式加载模块，模块的加载不影响它后面语句的运行。所有依赖这个模块的语句，都定义在一个回调函数中，等到加载完成之后，这个回调函数才会运行。这里介绍用require.js实现AMD规范的模块化：用<code>require.config()</code>指定引用路径等，用<code>define()</code>定义模块，用<code>require()</code>加载模块。</p> <p>首先我们需要引入require.js文件和一个入口文件main.js。main.js中配置<code>require.config()</code>并规定项目中用到的基础模块。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/** 网页中引入require.js及main.js **/</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;js/require.js&quot;</span> data<span class="token operator">-</span>main<span class="token operator">=</span><span class="token string">&quot;js/main&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token comment">/** main.js 入口文件/主模块 **/</span>
<span class="token comment">// 首先用config()指定各模块路径和引用名</span>
require<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">baseUrl</span><span class="token operator">:</span> <span class="token string">&quot;js/lib&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">paths</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;jquery&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jquery.min&quot;</span><span class="token punctuation">,</span>  <span class="token comment">//实际路径为js/lib/jquery.min.js</span>
    <span class="token string-property property">&quot;underscore&quot;</span><span class="token operator">:</span> <span class="token string">&quot;underscore.min&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 执行基本操作</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;jquery&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;underscore&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">$<span class="token punctuation">,</span>_</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// some code here</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_3-es6-module"><a href="#_3-es6-module" class="header-anchor">#</a> 3.ES6 Module</h3> <p>ES6 在语言标准的层面上，实现了模块功能，而且实现得相当简单，旨在成为浏览器和服务器通用的模块解决方案。其模块功能主要由两个命令构成：<code>export</code>和<code>import</code>。<code>export</code>命令用于规定模块的对外接口，<code>import</code>命令用于输入其他模块提供的功能。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/** 定义模块 math.js **/</span>
<span class="token keyword">var</span> basicNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> basicNum<span class="token punctuation">,</span> add <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/** 引用模块 **/</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> basicNum<span class="token punctuation">,</span> add <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./math'</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">ele</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ele<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">99</span> <span class="token operator">+</span> basicNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如上例所示，使用<code>import</code>命令的时候，用户需要知道所要加载的变量名或函数名。其实ES6还提供了<code>export default</code>命令，为模块指定默认输出，对应的<code>import</code>语句不需要使用大括号。这也更趋近于AMD的引用写法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/** export default **/</span>
<span class="token comment">//定义输出</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span> basicNum<span class="token punctuation">,</span> add <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//引入</span>
<span class="token keyword">import</span> math <span class="token keyword">from</span> <span class="token string">'./math'</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">ele</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ele<span class="token punctuation">.</span>textContent <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">99</span> <span class="token operator">+</span> math<span class="token punctuation">.</span>basicNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ES6的模块不是对象，<code>import</code>命令会被 JavaScript 引擎静态分析，在编译时就引入模块代码，而不是在代码运行时加载，所以无法实现条件加载。也正因为这个，使得静态分析成为可能。</p> <h3 id="_4-es6-模块与-commonjs模块的差异"><a href="#_4-es6-模块与-commonjs模块的差异" class="header-anchor">#</a> 4.ES6 模块与 CommonJS模块的差异</h3> <p><strong>1.CommonJS 模块输出的是一个值的拷贝，ES6 模块输出的是值的引用。</strong></p> <ul><li>CommonJS 模块输出的是值的拷贝，也就是说，一旦输出一个值，模块内部的变化就影响不到这个值。</li> <li>ES6 模块的运行机制与 CommonJS 不一样。JS 引擎对脚本静态分析的时候，遇到模块加载命令<code>import</code>，就会生成一个只读引用。等到脚本真正执行时，再根据这个只读引用，到被加载的那个模块里面去取值。换句话说，ES6 的<code>import</code>有点像 Unix 系统的“符号连接”，原始值变了，<code>import</code>加载的值也会跟着变。因此，ES6 模块是动态引用，并且不会缓存值，模块里面的变量绑定其所在的模块。</li></ul> <p><strong>2. CommonJS 模块是运行时加载，ES6 模块是编译时输出接口。</strong></p> <ul><li>运行时加载: CommonJS 模块就是对象；即在输入时是先加载整个模块，生成一个对象，然后再从这个对象上面读取方法，这种加载称为“运行时加载”。</li> <li>编译时加载: ES6 模块不是对象，而是通过 <code>export</code> 命令显式指定输出的代码，<code>import</code>时采用静态命令的形式。即在<code>import</code>时可以指定加载某个输出值，而不是加载整个模块，这种加载称为“编译时加载”。</li></ul> <p>CommonJS 加载的是一个对象（即<code>module.exports</code>属性），该对象只有在脚本运行完才会生成。而 ES6 模块不是对象，它的对外接口只是一种静态定义，在代码静态解析阶段就会生成。</p> <h2 id="_5-描述以下变量的区别-null-undefined-或-undeclared-dɪˈkleəd"><a href="#_5-描述以下变量的区别-null-undefined-或-undeclared-dɪˈkleəd" class="header-anchor">#</a> 5.描述以下变量的区别：<code>null</code>，<code>undefined</code> 或 <code>undeclared</code>(/ dɪˈkleəd /)？</h2> <p><strong>1.null 和 undefined的区别</strong></p> <p>null表示没有对象，即该处不应该有值</p> <ol><li>作为函数的参数，表示该函数的参数不是对象</li> <li>作为对象原型链的终点</li></ol> <p>undefined表示缺少值，即此处应该有值，但没有定义</p> <ol><li>定义了形参，没有传实参，显示undefined</li> <li>对象属性名不存在时，显示undefined</li> <li>函数没有写返回值，即没有写return，拿到的是undefined</li> <li>写了return，但没有赋值，拿到的是undefined</li></ol> <p>null和undefined转换成number数据类型</p> <ol><li>null 默认转成 0</li> <li>undefined 默认转成 NaN</li></ol> <p><strong>2.undefined 和 undeclared的区别</strong></p> <ul><li>在变量作用域中已经申明但没有赋值的变量（如 a），是undefined；</li> <li>在变量作用域中没有申明过的变量，是undeclared</li></ul> <p>但需要注意typeof undefined和typeof undeclared变量的结果都是undefined</p> <h2 id="_6-请举出一个匿名函数的典型用例"><a href="#_6-请举出一个匿名函数的典型用例" class="header-anchor">#</a> 6.请举出一个匿名函数的典型用例</h2> <p><strong>用于回调函数</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token parameter">args<span class="token punctuation">,</span>callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> args<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">demo</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_7-js的宿主对象和原生对象的区别"><a href="#_7-js的宿主对象和原生对象的区别" class="header-anchor">#</a> 7.JS的宿主对象和原生对象的区别</h2> <p>所有非原生对象都是宿主对象。</p> <p>宿主对象是指JS运行的平台或者说环境（即“操作系统”和“浏览器”）提供的对象，所有的<code>BOM</code>和<code>DOM</code>都是宿主对象，它们属于window对象的子对象。</p> <p>原生对象是&quot; <strong>独立于宿主环境的 ECMAScript 实现提供的对象</strong> &quot;。每一种宿主环境都可以使用原生对象。</p> <p>例如常见的：Object、Function、Array、String、Boolean、Math、Number、Date、RegExp、Error、EvalError、RangeError、ReferenceError、SyntaxError、TypeError、URIError和Global。</p> <p>**Tips：**内置对象（这意味着开发者无需使用new +构造函数创建，而是JavaScript引擎初始化的时候就被创建，可以直接使用。 目前定义的内置对象只有两个：<strong>Global</strong> 和 <strong>Math</strong>）</p> <h2 id="_8-call和apply的区别是什么"><a href="#_8-call和apply的区别是什么" class="header-anchor">#</a> 8. call和apply的区别是什么？</h2> <p>call和apply的很重要的区别在于传入参数。</p> <p>call和apply的第一个参数规则相同，后面的参数中：</p> <ul><li>call可以接收任意个参数</li> <li>apply只能再接收一个参数（必须是数组或者类数组，它们会被转换成类数组）</li></ul> <p>无论是call 还是apply，传入参数后面会映射到Function对应的参数上</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">func</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token function">func</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment">// func 接收到的参数实际上是 1,2,3</span>

<span class="token function">func</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// func 接收到的参数实际上是 [1,2,3],undefined,undefined</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">Function</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">,</span>argArray<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_9-bind的手写"><a href="#_9-bind的手写" class="header-anchor">#</a> 9.bind的手写</h2> <h2 id="_10-ajax的工作原理以及优缺点"><a href="#_10-ajax的工作原理以及优缺点" class="header-anchor">#</a> 10.Ajax的工作原理以及优缺点</h2> <p>Ajax是异步的 JavaScript 和 XML，它可以实现在不重新加载整个页面的情况下与服务器交换数据并局部更新网页。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> xmlHttp<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>XMLHttpRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment">//非IE</span>
    xmlHttp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>ActiveXObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token comment">//IE</span>
    xmlHttp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span><span class="token string">&quot;Microsoft.XMLHTTP&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">&quot;http://localhost:8080/JsLearning/getAjax&quot;</span><span class="token punctuation">;</span>
xmlHttp<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

xmlHttp<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xmlHttp<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>xmlHttp<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> obj <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
            obj<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> xmlHttp<span class="token punctuation">.</span>responseText<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;AJAX服务器返回错误！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringfy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'lcx'</span><span class="token punctuation">,</span><span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">'123456'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xmlHttp<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json;charset=UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xmhHttp<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>优点：</strong></p> <ol><li>最大的优点就是页面无需刷新，在页面内与服务器通信，非常好的用户体验。</li> <li>使用异步的方式与服务器通信，不需要中断操作。</li> <li>可以把以前服务器负担的工作转嫁给客户端，减轻服务器和带宽，可以最大程度减少冗余请求。</li> <li>基于标准化的并被广泛支持的技术，不需要下载插件或者小程序。</li></ol> <p><strong>缺点：</strong></p> <ol><li>AJAX干掉了Back和History功能，即对浏览器机制的破坏。 无法使用浏览器前进后退。</li> <li>安全问题：跨站脚本攻击、SQL注入攻击等。</li> <li>对搜索引擎的支持比较弱。如果使用不当，AJAX会增大网络数据的流量，从而降低整个系统的性能。</li></ol> <h2 id="_11-jsonp的原理"><a href="#_11-jsonp的原理" class="header-anchor">#</a> 11.JSONP的原理</h2> <p>本质是利用script标签的src属性没有跨域的特性。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
      window<span class="token punctuation">.</span><span class="token function-variable function">callback</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'触发callback函数'</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>  
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;http://127.0.0.1:5500/jsonp.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>


<span class="token operator">--</span><span class="token operator">-</span>jsonp<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token function">callback</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2023/png/26762664/1672743747755-7f512db7-e6ee-469e-b71c-12dc6f14905b.png#averageHue=%23222427&amp;clientId=u8c93e3cd-3960-4&amp;from=paste&amp;height=201&amp;id=uc93bfdda&amp;name=image-20220930195814699.png&amp;originHeight=251&amp;originWidth=383&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=4991&amp;status=done&amp;style=none&amp;taskId=u145ee01a-c66e-4f7e-8e40-1ec06587d08&amp;title=&amp;width=306.4" alt="image-20220930195814699.png"></p> <h2 id="_12-请解释变量声明提升"><a href="#_12-请解释变量声明提升" class="header-anchor">#</a> 12.请解释变量声明提升</h2> <p>我从三个常用声明方式开始说起：<code>var</code> <code>let</code> <code>const</code></p> <p>var 声明会被拿到函数或全局作用域的顶部，位于作用域中所有代码之前。这个现象叫作“提升” （hoisting）。</p> <p>比如我可以</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>name<span class="token operator">=</span> <span class="token string">&quot;李同学&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 李同学而非报错</span>
<span class="token keyword">var</span> name<span class="token punctuation">;</span>
</code></pre></div><p>而<code>let</code>声明和<code>var</code>也很相似，只不过它的作用域是块级的，而且在同一作用域不能重复声明，严格讲，<code>let</code>在js运行中也会被提升，但是由于“暂时性死区”的缘故，实际上不能在声明之前使用<code>let</code>变量。</p> <p>最后是<code>const</code>声明，const 的行为与 let 基本相同，唯一一个重要的区别是用它声明变量时必须同时初始化变量，且尝试修改 const 声明的变量会导致运行时错误
<img src="https://cdn.nlark.com/yuque/0/2023/png/26762664/1672743793276-10ec09a7-fdf0-4071-a712-d2979f8f6269.png#averageHue=%235f8597&amp;clientId=u8c93e3cd-3960-4&amp;from=paste&amp;height=326&amp;id=u22c1d2d0&amp;name=image-20220930205810605.png&amp;originHeight=408&amp;originWidth=785&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=24492&amp;status=done&amp;style=none&amp;taskId=uaadf8ef5-6fe8-41e4-9e0c-cfee7cdbc25&amp;title=&amp;width=628" alt="image-20220930205810605.png"></p> <p><code>const</code>和<code>let</code>报错类型不一样，<code>const</code>是<strong>SyntaxError</strong>，<code>let</code>是<strong>ReferenceError</strong></p> <h2 id="_13-请描述事件捕获和事件冒泡机制"><a href="#_13-请描述事件捕获和事件冒泡机制" class="header-anchor">#</a> 13.请描述事件捕获和事件冒泡机制</h2> <p>DOM事件流（event flow ）存在三个阶段：<strong>事件捕获阶段、</strong> <strong>处于目标阶段、</strong> <strong>事件冒泡阶段。</strong></p> <p><strong>事件捕获（event  capturing）</strong>：通俗的理解就是，当鼠标点击或者触发dom事件时，浏览器会从根节点开始<strong>由外到内</strong>进行事件传播，即点击了子元素，如果父元素通过事件捕获方式注册了对应的事件的话，会先触发父元素绑定的事件。</p> <p><strong>事件冒泡（dubbed  bubbling）</strong>：与事件捕获恰恰相反，事件冒泡顺序是<strong>由内到外</strong>进行事件传播，直到根节点。</p> <p>dom标准事件流的触发的先后顺序为：<strong>先捕获再冒泡</strong>，即当触发dom事件时，会先进行事件捕获，捕获到事件源之后通过事件传播进行事件冒泡。不同的浏览器对此有着不同的实现，IE10及以下不支持捕获型事件，所以就少了一个事件捕获阶段，<strong>IE11、Chrome 、Firefox、Safari等浏览器则同时存在。</strong></p> <h3 id="addeventlistener-方法"><a href="#addeventlistener-方法" class="header-anchor">#</a> addEventListener()方法</h3> <p>这个方法设定一个事件监听器，当某一事件发生通过设定的参数执行操作。语法是：</p> <p><strong>addEventListener(event, function, useCapture)</strong></p> <p>参数 <strong>event</strong> 是必须的，表示监听的事件，例如 click, touchstart 等，就是之前不加前缀 on 的事件。</p> <p>参数 <strong>function</strong> 也是必须的，表示事件触发后调用的函数，可以是外部定义函数，也可以是匿名函数。</p> <p>参数 <strong>useCapture</strong> 是选填的，填<strong>true</strong>或者<strong>false</strong>，用于描述事件是冒泡还是捕获，true表示捕获，默认的false表示冒泡。</p> <h3 id="如何阻止"><a href="#如何阻止" class="header-anchor">#</a> 如何阻止？</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">stopBubble</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">&amp;&amp;</span> e<span class="token punctuation">.</span>stopPropagation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//因此它支持W3C的stopPropagation()方法 </span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        window<span class="token punctuation">.</span>event<span class="token punctuation">.</span>cancelBubble <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//否则，我们需要使用IE的方式来取消事件冒泡 </span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>grandmother<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>grandmother
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mother<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>mother
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>son<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>son
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>baby<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>baby<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">div.baby</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span>100px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> lightblue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">div.son</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span>220px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 220px<span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> yellow<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">div.mother</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span>640px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 640px<span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">div.grandmother</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span>860px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 860px<span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> aquamarine<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">let</span> g_dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'grandmother'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> m_dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'mother'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> s_dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'son'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> b_dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'baby'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    g_dom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">stopBubble</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'grandmother'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    m_dom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">stopBubble</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mother'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    s_dom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">stopBubble</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'son'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    b_dom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">stopBubble</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'baby'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span>

    <span class="token keyword">function</span> <span class="token function">stopBubble</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">&amp;&amp;</span> e<span class="token punctuation">.</span>stopPropagation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//因此它支持W3C的stopPropagation()方法 </span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            window<span class="token punctuation">.</span>event<span class="token punctuation">.</span>cancelBubble <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//否则，我们需要使用IE的方式来取消事件冒泡 </span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2023/png/26762664/1672743818323-d37c926b-733d-49cc-ad2d-cb8c32a63f3a.png#averageHue=%23272d34&amp;clientId=u8c93e3cd-3960-4&amp;from=paste&amp;height=548&amp;id=ue2e9e496&amp;name=image-20220930213438612.png&amp;originHeight=685&amp;originWidth=1691&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=400184&amp;status=done&amp;style=none&amp;taskId=u72007b74-c2fb-4b2d-98da-63b98b64843&amp;title=&amp;width=1352.8" alt="image-20220930213438612.png"></p> <h2 id="_14-attribute和property的区别是什么"><a href="#_14-attribute和property的区别是什么" class="header-anchor">#</a> 14.Attribute和Property的区别是什么？</h2> <blockquote><p>attribute 是 HTML 标签上的特性，也就是 html 代码中经常看到的键值对</p></blockquote> <blockquote><p>property 是 DOM 中的属性，是 JavaScript 里的对象</p></blockquote> <h5 id="attribute"><a href="#attribute" class="header-anchor">#</a> Attribute</h5> <ul><li>值只能为 <code>string</code> 类型</li> <li>如果编辑 HTML 时设置了元素的 attribute 值，之后就算改了这个值，attribute 依旧是默认的值。</li> <li>允许创建自定义的值</li></ul> <h5 id="property"><a href="#property" class="header-anchor">#</a> property</h5> <ul><li>值可以是多种类型：<code>boolean，string，number等</code>都可以</li> <li>可以通过 DOM 对象访问</li> <li>或许不到规定属性以外的自定义属性</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>input id<span class="token operator">=</span><span class="token string">&quot;the-input&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;typo&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;Name:&quot;</span> customAttr<span class="token operator">=</span><span class="token string">&quot;customAttr&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span> 
<span class="token comment">// 在页面加载后,在input中输入 &quot;Jack&quot;</span>
<span class="token comment">// type 属性给的值为 typo，并不属于 input 支持的 type 种类</span>

input<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span> <span class="token comment">// the-input</span>
input<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">)</span> <span class="token comment">// typo</span>
input<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'value'</span><span class="token punctuation">)</span> <span class="token comment">// Name:</span>
input<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;customAttr&quot;</span><span class="token punctuation">)</span> <span class="token comment">// customAttr</span>

input<span class="token punctuation">.</span>id <span class="token comment">// the-input</span>
input<span class="token punctuation">.</span>type <span class="token comment">// text</span>
input<span class="token punctuation">.</span>value <span class="token comment">// Jack</span>
inout<span class="token punctuation">.</span>customAttr <span class="token comment">// undefined</span>
</code></pre></div><p><strong>DOM 节点在初始化的时候会将 html 规范中定义的 attribute 赋值到 property 上。而自定义的 attribute 并不属于这个范围内，自然生成的 DOM 节点就没有这个 property。</strong></p> <h2 id="_15-请解释js的同源策略"><a href="#_15-请解释js的同源策略" class="header-anchor">#</a> 15.请解释js的同源策略</h2> <p>js同源策略是指客户端脚本只能读取来自同一来源的窗口和文档的属性，</p> <p>这里的同源有三个方面：<strong>协议/域名/端口</strong></p> <h2 id="_16-如何实现下列代码"><a href="#_16-如何实现下列代码" class="header-anchor">#</a> 16.如何实现下列代码</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">duplicator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1,2,3,4,5,1,2,3,4,5]</span>


<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">duplicator</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
array<span class="token punctuation">.</span><span class="token function">duplicator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// [1,2,3,4,5,1,2,3,4,5]</span>
</code></pre></div><h2 id="_17-三元表达式"><a href="#_17-三元表达式" class="header-anchor">#</a> 17.三元表达式</h2> <p>三元表达式又叫三元运算符，一个三元表达式是一个进行求值的条件表达式。它由一个条件判断，一个真值子句（truthy value，当条件为真时返回的值）和一个假值子句（falsy clause，当条件为假时返回的值）构成。</p> <p>三元表示三个操作数。</p> <h2 id="_18-什么是-use-strict-使用它的好处和坏处分别是什么"><a href="#_18-什么是-use-strict-使用它的好处和坏处分别是什么" class="header-anchor">#</a> 18.什么是 <code>&quot;use strict&quot;;</code> ? 使用它的好处和坏处分别是什么？</h2> <p>这是指js的严格模式，即代码在严格的条件下运行，这个指令是在es5中新增的。</p> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/26762664/1672743834500-f9b4e572-9c9b-47ac-995a-3515b2b081d0.png#averageHue=%235a6568&amp;clientId=u8c93e3cd-3960-4&amp;from=paste&amp;height=198&amp;id=ucc655861&amp;name=image-20221005144925416.png&amp;originHeight=247&amp;originWidth=525&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=11041&amp;status=done&amp;style=none&amp;taskId=u1e1f2f75-b112-4505-ac09-f910d05ab0f&amp;title=&amp;width=420" alt="image-20221005144925416.png"></p> <p><strong>好处：</strong></p> <ul><li>消除Javascript语法的一些不合理、不严谨之处，减少一些怪异行为;</li> <li>消除代码运行的一些不安全之处，保证代码运行的安全；</li> <li>提高编译器效率，增加运行速度；</li> <li>为未来新版本的Javascript做好铺垫。</li></ul> <p><strong>坏处：</strong></p> <p>严格模式改变了语义。因为在开发工作中，有些东西可能是开发人员习以为常或者思维导向就潜移默化有了一定的规则，如果依赖严格模式这些改变可能会导致没有实现严格模式的浏览器中出现问题或者错误。</p> <h2 id="_19-说说promise"><a href="#_19-说说promise" class="header-anchor">#</a> 19.说说Promise</h2> <p>Promise 是异步编程的一种解决方案，比传统的解决方案——回调函数和事件——更合理和更强大。它由社区最早提出和实现，ES6 将其写进了语言标准，统一了用法，原生提供了<code>Promise</code>对象。</p> <p><code>Promise</code>，简单说就是一个容器，里面保存着某个未来才会结束的事件（通常是一个异步操作）的结果。</p> <p><code>Promise</code>对象有以下两个特点。</p> <p>（1）对象的状态不受外界影响。<code>Promise</code>对象代表一个异步操作，有三种状态：<code>pending</code>（进行中）、<code>fulfilled</code>（已成功）和<code>rejected</code>（已失败）。只有异步操作的结果，可以决定当前是哪一种状态，任何其他操作都无法改变这个状态。这也是<code>Promise</code>这个名字的由来，它的英语意思就是“承诺”，表示其他手段无法改变。</p> <p>（2）一旦状态改变，就不会再变，任何时候都可以得到这个结果。<code>Promise</code>对象的状态改变，只有两种可能：从<code>pending</code>变为<code>fulfilled</code>和从<code>pending</code>变为<code>rejected</code>。只要这两种情况发生，状态就凝固了，不会再变了，会一直保持这个结果，这时就称为 resolved（已定型）。如果改变已经发生了，你再对<code>Promise</code>对象添加回调函数，也会立即得到这个结果。这与事件（Event）完全不同，事件的特点是，如果你错过了它，再去监听，是得不到结果的。</p> <p>有了<code>Promise</code>对象，就可以将异步操作以同步操作的流程表达出来，避免了层层嵌套的回调函数。此外，<code>Promise</code>对象提供统一的接口，使得控制异步操作更加容易。</p> <p><code>Promise</code>也有一些缺点。首先，无法取消<code>Promise</code>，一旦新建它就会立即执行，无法中途取消。其次，如果不设置回调函数，<code>Promise</code>内部抛出的错误，不会反应到外部。第三，当处于<code>pending</code>状态时，无法得知目前进展到哪一个阶段（刚刚开始还是即将完成）。</p> <h2 id="_20-请解释同步和异步函数的区别"><a href="#_20-请解释同步和异步函数的区别" class="header-anchor">#</a> 20.请解释同步和异步函数的区别</h2> <p>由于js是单线程语言，意味着一个时间只能处理一件事情，且是按一定顺序依次执行，虽然这简化了编程代码，不必担心并发引出的问题，但同时也说明如果遇到一些会阻塞主线程的任务执行时，执行栈只能等待其执行完，这将造成资源浪费等。</p> <p>因此这时候就很有必要引入异步js的，异步函数能实现异步回调来避免阻塞情况发生，如<code>promise</code>,<code>asycn</code></p> <h2 id="_21-函数声明和函数表达式的区别"><a href="#_21-函数声明和函数表达式的区别" class="header-anchor">#</a> 21.函数声明和函数表达式的区别</h2> <p><strong>区别主要在所关联到的函数什么时候真正有定义</strong></p> <p>JavaScript 引擎在任何代码执行之前，会先读取函数声明，并在执行上下文中 生成函数定义。而函数表达式必须等到代码执行到它那一行，才会在执行上下文中生成函数定义。
<img src="https://cdn.nlark.com/yuque/0/2023/png/26762664/1672743853384-491abe88-a9a2-4182-90eb-c5eb2e353979.png#averageHue=%23212327&amp;clientId=u8c93e3cd-3960-4&amp;from=paste&amp;height=282&amp;id=ua31caa7a&amp;name=image-20221005201952896.png&amp;originHeight=352&amp;originWidth=521&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=20894&amp;status=done&amp;style=none&amp;taskId=ue901f035-07bf-469d-896a-89a673b3ff2&amp;title=&amp;width=416.8" alt="image-20221005201952896.png"></p> <h2 id="_22-settimeout和promise的区别"><a href="#_22-settimeout和promise的区别" class="header-anchor">#</a> 22.setTimeout和promise的区别</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'then'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'console'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这段代码作为宏任务进入主线程，从上往下读取</p> <ul><li>首先读取到<code>setTimeout</code>，将其回调函数注册并分发到宏任务事件队列</li> <li>接下来遇到<code>Promise</code>，<code>new promise</code>会立刻执行，将<code>then</code>回调函数分发到微任务队列</li> <li>最后遇到<code>console</code>，立刻执行输出</li> <li>第一个宏任务执行结束后，进入当前微任务事件队列，执行输出，第一次事件循环结束</li> <li>开启第二次循环，首先读取宏任务队列...</li></ul> <p>所以这段代码输出顺序： promise，console，then，setTimeout</p> <p>主线程：JS单线程引擎，也即我们常说的主线程。</p> <p>异步任务：宏任务和微任务，微任务比宏任务优先执行，宏任务放进消息队列(Message Queue) 微任务放进微任务队列(Microtask Queue)</p> <p>宏任务优先，在宏任务执行完毕之后才会来一次性清空任务队列中的所有微任务，执行完微任务再执行下一个宏任务，这样循环下去直至全部任务执行完毕。
<img src="https://cdn.nlark.com/yuque/0/2023/png/26762664/1672743869162-499d4971-829a-448c-bfd8-2179a2354de5.png#averageHue=%23080707&amp;clientId=u8c93e3cd-3960-4&amp;from=paste&amp;height=695&amp;id=u2980bce4&amp;name=image-20220607152619907.png&amp;originHeight=869&amp;originWidth=1290&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=252508&amp;status=done&amp;style=none&amp;taskId=u7d6714d9-723c-4fce-b0a8-635227abdb8&amp;title=&amp;width=1032" alt="image-20220607152619907.png"></p> <h2 id="_23-什么是事件循环-event-loop"><a href="#_23-什么是事件循环-event-loop" class="header-anchor">#</a> 23.什么是事件循环 Event loop</h2> <p>事件循环就是解决javaScript单线程对于异步操作的一些缺陷，让 javaScript做到既是<strong>单线程</strong>，又绝对<strong>不会阻塞</strong>的核心机制，是用来协调各种事件、用户交互、脚本执行、UI 渲染、网络请求等的一种机制。</p> <p><strong>常见微任务：</strong></p> <p>promise.then()、MutaionObserver、process.nextTick(Node.js 环境)、async&amp;&amp;await后面的代码(如下)</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">await</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//等价于</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>**常见宏任务：**setTimeout()、setInteval、xhr</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 宏 1</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'北歌'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 微1-1</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 微1-4 =&gt; 这个then中的会等待上一个then执行完成之后得到其状态才会向Queue注册状态对应的回调，假设上一个then中主动抛错且没有捕获，那就注册的是这个then中的第二个回调了。</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// =&gt; await(promise的语法糖)，会异步等待获取其返回值</span>
  <span class="token comment">// =&gt; 后面的代码可以理解为放到异步队列微任务中。 这里可以保留疑问后面会详细说</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span> <span class="token comment">// 微1-2</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async2 end'</span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">errorFunc</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'error!!!'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// =&gt; 从这后面开始所有的代码可以理解为放到异步队列微任务中</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>  <span class="token comment">// 微1-3</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'async1 success'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">errorFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 微1-5</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>例子：</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">//promise1-1</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//fulfilled</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">//回调还没执行，返回一个状态为pending的promise，使得b回调还没进入微任务队列，等待中</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">//promise2-1</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//fulfilled</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">//回调还没执行，返回一个状态为pending的promise，使得d回调还没进入微任务队列，等待中</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>尝试打印顺序：</strong></p> <p>1</p> <p>清空微任务第一次(执行a回调) 2  3</p> <p>此时a回调执行完毕，没有返回值也即undefined，promise状态改为fulfilled，b回调进入微任务队列，注意c回调比b回调先进入微任务队列。</p> <p>接着清空微任务第二次(执行c回调、b回调) 4 5</p> <p>此时c回调执行完毕，同理d回调进入微任务队列。</p> <p>最后清空微任务第三次(指定d回调) 6</p> <p>综上，打印1、2、3、4、5、6</p> <p><strong>例子：</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//此时c回调、b回调可以进入微任务队列了</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
        <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//此时e回调、d回调可以进入微任务队列了</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Promise.then(()=&gt;{</p> <div class="language- extra-class"><pre><code>....
</code></pre></div><p>}).then(()=&gt;{</p> <div class="language- extra-class"><pre><code>.....
</code></pre></div><p>})</p> <p>then回调的执行必须在上一个promise的状态为fulfilled，所以第二个then其实是被缓存在它前面new出来的_promise_内部的回调队列里，等promise的状态改变再放入微任务队列。</p> <p>尝试打印顺序：</p> <p>1 -&gt; resolve1()说明状态为fulfilled，a回调进入微任务队列，b回调等待。</p> <p>清空微任务队列第一次（执行a回调）2  3  -&gt;resolve() 说明状态为fulfilled，c回调进入微任务队列，d回调等待。（注意！此时a回调执行完毕，没有返回值，then返回的promise状态为fulfilled）</p> <p>这时b回调可以进入微任务队列了，但是在c回调之后。</p> <p>清空微任务队列第二次（执行c回调，b回调） 4 5 resolve() 说明状态为fulfilled 6 ，e回调进入微任务队列，f回调等待。（注意！此时c回调执行完毕，没有返回值，then返回的promise状态为fulfilled）</p> <p>这时d回调可以进入微任务队列了，但是在e回调之后。</p> <p>清空微任务队列第三次（执行e回调，d回调） 7 这时f回调可以进入微任务队列了 8</p> <p>清空微任务队列第四次（执行f回调）9</p> <hr> <h2 id="_24-什么是闭包-词法作用域"><a href="#_24-什么是闭包-词法作用域" class="header-anchor">#</a> 24.什么是闭包(词法作用域)？</h2> <p><strong>概念：在 JavaScript 中，根据词法作用域的规则，内部函数总是可以访问其外部函数中声明的变量，当通过调用一个外部函数返回一个内部函数后，即使该外部函数已经执行结束了，但是内部函数引用外部函数的变量依然保存在内存中，我们就把这些变量的集合称为闭包。</strong></p> <p>在JS中变量的作用域属于函数作用域，在函数执行完后，作用域会被清理，内存也随之被回收，但由于<strong>闭包函数是建立在函数内部的子函数，因其可以访问上级作用域，即使上级函数执行完，作用域也不会随之销毁，这时的子函数（也就是闭包），便拥有了访问上级作用域中变量的权限，即使上级函数执行完后作用域内的值也不会被销毁。</strong></p> <h5 id="闭包解决了什么问题"><a href="#闭包解决了什么问题" class="header-anchor">#</a> 闭包解决了什么问题？</h5> <ol><li>可以读取函数内部的变量</li> <li>让这些变量的值始终保持在内存中。不会在函数调用后被清除</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">addCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token number">0</span>
   <span class="token keyword">const</span> <span class="token function-variable function">myFunction</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     counter <span class="token operator">=</span> counter <span class="token operator">+</span> <span class="token number">1</span>
     <span class="token keyword">return</span> counter
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> myFunction
 <span class="token punctuation">}</span>
 <span class="token keyword">const</span> increment <span class="token operator">=</span> <span class="token function">addCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">const</span> c1 <span class="token operator">=</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">const</span> c2 <span class="token operator">=</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">const</span> c3 <span class="token operator">=</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'increment:'</span><span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> c3<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在这段代码中<code>increment</code>实际上就是闭包函数<code>myFunction</code>, 它一共运行了三次，第一次的值是1，第二次的值是2，第三次的值是3。这证明了，函数<code>addCounter</code>中的局部变量<code>counter</code>一直保存在内存中，并没有在<code>addCounter</code>调用后被自动清除。</p> <h5 id="应用场景"><a href="#应用场景" class="header-anchor">#</a> <strong>应用场景：</strong></h5> <p>1.取正确值问题</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">//10个10</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

<span class="token comment">//闭包用法</span>
 <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">j</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token comment">//1-10</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">// 声明了10个自执行函数，保存当时的值到内部</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>2.模拟私有变量</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> privateCounter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">changeBy</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      privateCounter <span class="token operator">+=</span> val
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">increment</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">changeBy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">decrement</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">changeBy</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">value</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> privateCounter
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  counter<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//0</span>
  counter<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//1</span>
  counter<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//2</span>
  counter<span class="token punctuation">.</span><span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//1</span>
</code></pre></div><p>匿名函数已经定义就立即执行, 创建出一个词法环境包含<code>counter.increment</code>、<code>counter.decrement</code>、<code>counter.value</code>三个方法,还包含了两个私有项:<code>privateCounter</code>变量和<code>changeBy</code>函数。这两个私有项无法在匿名函数外部直接访问，必须通过匿名包装器返回的对象的三个公共函数访问。</p> <h5 id="闭包的缺点"><a href="#闭包的缺点" class="header-anchor">#</a> 闭包的缺点</h5> <ol><li>由于闭包会使得函数中的变量都被保存到内存中,滥用闭包很容易造成内存消耗过大,导致网页性能问题。解决方法是在退出函数之前，将不再使用的局部变量全部删除。</li> <li>闭包可以使得函数内部的值可以在函数外部进行修改。所有，如果你把父函数当作对象（object）使用，把闭包当作它的公用方法（Public Method），把内部变量当作它的私有属性（private value），这时一定要小心，不要随便改变父函数内部变量的值。</li></ol> <h2 id="_25-for-in-和for-of的区别"><a href="#_25-for-in-和for-of的区别" class="header-anchor">#</a> 25.for in 和for of的区别</h2> <p>简单来说就是它们两者都可以用于遍历，不过<code>for in</code>遍历的是数组的索引（<code>index</code>），而<code>for of</code>遍历的是数组元素值（<code>value</code>）</p> <ol><li>for...of 是ES6新引入的特性，修复了ES5引入的for...in的不足</li> <li>for...in 循环出的是key，for...of循环出的是value</li> <li>for...in会遍历数组所有的可枚举属性，包括原型，如果不想遍历原型方法和属性的话，可以在循环内部判断一下，使用<code>hasOwnProperty()</code>方法可以判断某属性是不是该对象的实例属性。for...of遍历的是数组元素值，而且for...of遍历的只是数组内的元素，不包括原型属性和索引</li> <li>for...of不能循环普通的对象，需要通过和Object.keys()搭配使用</li> <li>推荐在循环对象属性的时候，使用for...in,在遍历数组的时候的时候使用for...of</li></ol> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/26762664/1672743885299-028da925-48cd-47b5-830d-cf3a7a79c000.png#averageHue=%23fefdfc&amp;clientId=u8c93e3cd-3960-4&amp;from=paste&amp;height=278&amp;id=u0dc6d140&amp;name=image-20220608162434205.png&amp;originHeight=348&amp;originWidth=271&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=11019&amp;status=done&amp;style=none&amp;taskId=ue9fcd36e-3c09-4ec2-957d-5dc1080f37b&amp;title=&amp;width=216.8" alt="image-20220608162434205.png"></p> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/26762664/1672743885280-d93cf1ac-af9a-4c9c-ae94-f33f92598b0f.png#averageHue=%23fefbfa&amp;clientId=u8c93e3cd-3960-4&amp;from=paste&amp;height=369&amp;id=u440136c4&amp;name=image-20220608162551257.png&amp;originHeight=461&amp;originWidth=387&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=20277&amp;status=done&amp;style=none&amp;taskId=u3b747e45-1430-4e00-b0ee-cf94a43e408&amp;title=&amp;width=309.6" alt="image-20220608162551257.png"></p> <h2 id="_26-new一个对象-这个过程发生了什么"><a href="#_26-new一个对象-这个过程发生了什么" class="header-anchor">#</a> 26.new一个对象，这个过程发生了什么？</h2> <ol><li>创建一个新对象，如：var obj = {};</li> <li>新对象的_proto_属性指向构造函数的原型对象。</li> <li>将构造函数的作用域赋值给新对象。（也所以this对象指向新对象）</li> <li>执行构造函数内部的代码，将属性添加给obj中的this对象。</li> <li>返回新对象obj。</li></ol> <p><strong>补充：</strong></p> <p>在<code>JavaScript</code>中，<code>new</code>操作符用于创建一个给定构造函数的实例对象</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Tom'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1<span class="token punctuation">)</span>  <span class="token comment">// Person {name: &quot;Tom&quot;, age: 20}</span>
person1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'Tom'</span>
</code></pre></div><p>从上面可以看到：</p> <ul><li><code>new</code> 通过构造函数 <code>Person</code> 创建出来的实例可以访问到构造函数中的属性</li> <li><code>new</code> 通过构造函数 <code>Person</code> 创建出来的实例可以访问到构造函数原型链中的属性（即实例与构造函数通过原型链连接了起来）</li></ul> <p>现在在构建函数中显式加上返回值，并且这个返回值是一个原始类型</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">return</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// '123'</span>
</code></pre></div><p><strong>可以发现，构造函数中返回一个原始值，然而这个返回值并没有作用</strong>，下面在构造函数中返回一个对象</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">// Test { name: 'xxx' }</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">26</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token comment">// { age: 26 }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 'undefined'</span>
</code></pre></div><p><strong>从上面可以发现，构造函数如果返回值为一个对象，那么这个返回值会被正常使用。</strong></p> <p>以上，我们可以看到<code>new</code>关键字主要做了以下的工作：</p> <ul><li>创建一个新的对象<code>obj</code>，如：var obj = {}</li> <li>新对象的_proto_属性指向构造函数的原型对象</li> <li>将构建函数中的<code>this</code>绑定到新建的对象<code>obj</code>上</li> <li>执行构造函数内部的代码，将属性添加给obj中的this对象</li> <li>根据构造函数返回类型作判断，如果是原始值则被忽略，返回新对象obj；如果是返回已设置对象，则返回已设置对象</li></ul> <h3 id="手写new操作符"><a href="#手写new操作符" class="header-anchor">#</a> 手写new操作符：</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">mynew</span><span class="token punctuation">(</span><span class="token parameter">Func<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1.创建一个新对象</span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// 2.新对象原型指向构造函数原型对象</span>
    obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> <span class="token class-name">Func</span><span class="token punctuation">.</span>prototype
    <span class="token comment">// 3.将构建函数的this指向新对象</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">Func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token comment">// 4.根据返回值判断</span>
    <span class="token keyword">return</span> result <span class="token keyword">instanceof</span> <span class="token class-name">Object</span> <span class="token operator">?</span> result <span class="token operator">:</span> obj
<span class="token punctuation">}</span>
</code></pre></div><p><strong>测试：</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">mynew</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> func<span class="token punctuation">.</span>prototype
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token keyword">return</span> result <span class="token keyword">instanceof</span> <span class="token class-name">Object</span> <span class="token operator">?</span> result <span class="token operator">:</span> obj
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">say</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token function">mynew</span><span class="token punctuation">(</span>Person<span class="token punctuation">,</span> <span class="token string">&quot;huihui&quot;</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token comment">// Person {name: &quot;huihui&quot;, age: 123}</span>
p<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// huihui</span>
</code></pre></div><h2 id="_27-typeof-与-instanceof-区别"><a href="#_27-typeof-与-instanceof-区别" class="header-anchor">#</a> 27.typeof 与 instanceof 区别</h2> <h5 id="typeof"><a href="#typeof" class="header-anchor">#</a> typeof</h5> <p><code>typeof</code> 操作符返回一个字符串，表示未经计算的操作数的类型</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">typeof</span> <span class="token number">1</span> <span class="token comment">// 'number'</span>
<span class="token keyword">typeof</span> <span class="token string">'1'</span> <span class="token comment">// 'string'</span>
<span class="token keyword">typeof</span> <span class="token keyword">undefined</span> <span class="token comment">// 'undefined'</span>
<span class="token keyword">typeof</span> <span class="token boolean">true</span> <span class="token comment">// 'boolean'</span>
<span class="token keyword">typeof</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'symbol'</span>
<span class="token keyword">typeof</span> <span class="token keyword">null</span> <span class="token comment">// 'object'</span>
<span class="token keyword">typeof</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 'object'</span>
<span class="token keyword">typeof</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 'object'</span>
<span class="token keyword">typeof</span> console <span class="token comment">// 'object'</span>
<span class="token keyword">typeof</span> console<span class="token punctuation">.</span>log <span class="token comment">// 'function'</span>
</code></pre></div><p>typeof只能判断基本数据类型，引用类型的统一是<code>object</code>。值得注意的是，<code>null</code>不是引用数据类型，如果需要在 <code>if</code> 语句中判断是否为 <code>null</code>，直接通过<code>===null</code>来判断就好。</p> <p>如果我们想要判断一个变量是否存在，可以使用<code>typeof</code>：(不能使用<code>if(a)</code>， 若<code>a</code>未声明，则报错)</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> a <span class="token operator">!=</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//变量存在</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="instanceof"><a href="#instanceof" class="header-anchor">#</a> instanceof</h5> <p><code>instanceof</code> 运算符用于检测构造函数的 <code>prototype</code> 属性是否出现在某个实例对象的原型链上。</p> <p>使用如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>object <span class="token keyword">instanceof</span> <span class="token class-name">constructor</span>
</code></pre></div><p><code>object</code>为实例对象，<code>constructor</code>为构造函数</p> <p>构造函数通过<code>new</code>可以实例对象，<code>instanceof</code>能判断这个对象是否是之前那个构造函数生成的对象</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 定义构建函数</span>
<span class="token keyword">let</span> <span class="token function-variable function">Car</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> benz <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
benz <span class="token keyword">instanceof</span> <span class="token class-name">Car</span> <span class="token comment">// true</span>
<span class="token keyword">let</span> car <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">)</span>
car <span class="token keyword">instanceof</span> <span class="token class-name">String</span> <span class="token comment">// true</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">'xxx'</span>
str <span class="token keyword">instanceof</span> <span class="token class-name">String</span> <span class="token comment">// false</span>
</code></pre></div><p><strong>Instanceof的原理 -&gt; 原型链</strong></p> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/26762664/1672743925837-8a50d699-b400-46ca-b9b8-3e858b1daf86.png#averageHue=%23222526&amp;clientId=u8c93e3cd-3960-4&amp;from=paste&amp;height=434&amp;id=u516a8e5a&amp;name=image-20220608202024734.png&amp;originHeight=543&amp;originWidth=729&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=144588&amp;status=done&amp;style=none&amp;taskId=u00bfdbe0-ec29-415e-8189-e2680dec5ca&amp;title=&amp;width=583.2" alt="image-20220608202024734.png"><img src="https://cdn.nlark.com/yuque/0/2023/png/26762664/1672743926059-109ee5de-4049-4c35-b9bf-0fa6278c40c9.png#averageHue=%23424544&amp;clientId=u8c93e3cd-3960-4&amp;from=paste&amp;height=688&amp;id=u6ed72dd9&amp;name=image-20220608202216478.png&amp;originHeight=860&amp;originWidth=1520&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=519146&amp;status=done&amp;style=none&amp;taskId=u59f04fbc-5d93-4f9f-996b-5a6ffeb69f6&amp;title=&amp;width=1216" alt="image-20220608202216478.png"></p> <h3 id="手写instanceof"><a href="#手写instanceof" class="header-anchor">#</a> <strong>手写instanceof：</strong></h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">myInstanceof</span><span class="token punctuation">(</span><span class="token parameter">left<span class="token punctuation">,</span> right</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里先用typeof来判断基础数据类型，如果是，直接返回false</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> left <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> left <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">// getProtypeOf是Object对象自带的API，能够拿到参数的原型对象</span>
    <span class="token keyword">let</span> proto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                  
        <span class="token keyword">if</span><span class="token punctuation">(</span>proto <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>proto <span class="token operator">===</span> right<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//找到相同原型对象，返回true</span>
        proto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeof</span><span class="token punctuation">(</span>proto<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>这个问题的答案：</strong></p> <p><code>typeof</code>与<code>instanceof</code>都是判断数据类型的方法，区别如下：</p> <ul><li><code>typeof</code>会返回一个变量的基本类型，<code>instanceof</code>返回的是一个布尔值</li> <li><code>instanceof</code> 可以准确地判断复杂引用数据类型，但是不能正确判断基础数据类型</li> <li>而<code>typeof</code> 也存在弊端，它虽然可以判断基础数据类型（<code>null</code> 除外），但是引用数据类型中，除了<code>function</code> 类型以外，其他的也无法判断</li></ul> <p>可以看到，上述两种方法都有弊端，并不能满足所有场景的需求。</p> <p>如果需要通用检测数据类型，可以采用<code>Object.prototype.toString</code>，调用该方法，统一返回格式<code>“[object Xxx]”</code>的字符串。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>       <span class="token comment">// &quot;[object Object]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment">// 同上结果，加上call也ok</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment">// &quot;[object Number]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>  <span class="token comment">// &quot;[object String]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>  <span class="token comment">// &quot;[object Boolean]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment">// &quot;[object Function]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>   <span class="token comment">//&quot;[object Null]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token comment">//&quot;[object Undefined]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">123</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">)</span>    <span class="token comment">//&quot;[object RegExp]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//&quot;[object Date]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>       <span class="token comment">//&quot;[object Array]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span>  <span class="token comment">//&quot;[object HTMLDocument]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span>   <span class="token comment">//&quot;[object Window]&quot;</span>
</code></pre></div><p>了解了<code>toString</code>的基本用法，下面就实现一个全局通用的数据类型判断方法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getType</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> type  <span class="token operator">=</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">!==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// 先进行typeof判断，如果是基础数据类型，直接返回</span>
    <span class="token keyword">return</span> type<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 对于typeof返回结果是object的，再进行如下的判断，正则返回结果</span>
  <span class="token keyword">return</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\[object (\S+)\]$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">'$1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>     <span class="token comment">// &quot;Array&quot; typeof []是object，因此toString返回</span>
<span class="token function">getType</span><span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">)</span>  <span class="token comment">// &quot;string&quot; typeof 直接返回</span>
<span class="token function">getType</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span> <span class="token comment">// &quot;Window&quot; toString返回</span>
<span class="token function">getType</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>   <span class="token comment">// &quot;Null&quot;首字母大写，typeof null是object，需toString来判断</span>
<span class="token function">getType</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span>   <span class="token comment">// &quot;undefined&quot; typeof 直接返回</span>
<span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment">// &quot;undefined&quot; typeof 直接返回</span>
<span class="token function">getType</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// &quot;function&quot; typeof能判断，因此首字母小写</span>
<span class="token function">getType</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">123</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">)</span>      <span class="token comment">//&quot;RegExp&quot; toString返回</span>
</code></pre></div><h2 id="_28-跨域问题有哪些处理方式"><a href="#_28-跨域问题有哪些处理方式" class="header-anchor">#</a> 28.<strong>跨域问题有哪些处理方式</strong></h2> <ol><li>通过jsonp跨域</li> <li>跨域资源共享（CORS）</li> <li>nodejs中间件代理跨域</li> <li>nginx反向代理中设置proxy_cookie_domain</li></ol> <h2 id="_29-防抖和节流是什么"><a href="#_29-防抖和节流是什么" class="header-anchor">#</a> 29.防抖和节流是什么？</h2> <p><strong>概念</strong></p> <ul><li>防抖: 当连续触发事件时，最后一次触发事件后，只有任务触发的间隔超过指定间隔的时候，任务才会执行</li> <li>节流: 指定时间间隔内只会执行一次任务，当连续触发事件时，事件只按自己的时间间隔执行</li></ul> <p><strong>应用场景</strong></p> <ul><li>防抖
<ul><li>输入框搜索联动词频繁调用接口时</li></ul></li> <li>节流
<ul><li>懒加载要监听计算滚动条的位置，使用节流按一定时间的频率获取</li> <li>用户点击提交按钮，假设我们知道接口大致的返回时间的情况下，我们使用节流，只允许一定时间内点击一次</li></ul></li></ul> <p><strong>防抖是只执行最后一次_，_节流是控制执行次数</strong></p> <h2 id="_30-和-的区别"><a href="#_30-和-的区别" class="header-anchor">#</a> 30.== 和 ===的区别</h2> <p>== 比较是，会考虑类型是否一致，不一致进行转换的情况。像[] == ![]是true即因类型转换的结果导致。</p> <p><strong>部分比较规则：</strong></p> <ul><li>两个都为简单类型，字符串和布尔值都会转换成数值，再比较</li> <li>简单类型与引用类型比较，对象转化成其原始类型的值，再比较</li> <li>两个都为引用类型，则比较它们是否指向同一个对象</li> <li>null 和 undefined 相等</li> <li>存在 NaN 则返回 false</li></ul> <p>===比较就是类型和值都要相等。</p> <p><strong>例子：[] == ![]</strong></p> <p><strong>原理：</strong></p> <p><code>!</code>运算符优先级更高，先执行<code>![]</code> !为布尔，<code>![]</code>为false，<code>[]==false</code> ；</p> <p>然后有<code>==</code>将这两个向Number靠近，<code>[]</code>为引用类型，调用ToPrimitive() ，起初是用<code>valueOf()</code>没有得到原始类型，再调用<code>toString()</code>转换成<code>''</code>，最后转换成<code>0</code> ，<code>false</code>转换成<code>0</code>；</p> <p>所以<code>[]</code> <strong>==</strong> <code>![]</code>。</p> <h2 id="_31-其他途径"><a href="#_31-其他途径" class="header-anchor">#</a> 31.其他途径</h2> <p><a href="https://juejin.cn/post/6992525007716876325" target="_blank" rel="noopener noreferrer">100道面试题<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/learn-javascript/handbook/Knowledge/JsFirstStep.html" class="prev">
        JS知识
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/learn-javascript/assets/js/app.5bbd33bb.js" defer></script><script src="/learn-javascript/assets/js/2.6b100304.js" defer></script><script src="/learn-javascript/assets/js/10.e4551c7c.js" defer></script>
  </body>
</html>
